{% extends "base.html" %} {% block content %}
<!-- Welcome Header -->
<div class="text-center mb-12">
  <div
    class="inline-block bg-gradient-to-r from-gray-800 to-gray-900 text-white px-8 py-4 rounded-xl shadow-lg mb-4"
  >
    <h1 class="text-4xl font-bold mb-2">Church Cell Tracker</h1>
    <h2 class="text-xl font-semibold text-gray-300">
      Comprehensive Management System
    </h2>
  </div>

  <div class="text-gray-600 mb-6">
    <p class="text-lg bg-white p-4 rounded-lg shadow-sm inline-block">
      <i class="fas fa-calendar-alt text-accent mr-2"></i>
      {{ datetime.now().strftime('%A, %B %d, %Y') }} · Next service at 7:00 PM
    </p>
  </div>

  <div
    class="w-32 h-1 bg-gradient-to-r from-accent to-accent-dark mx-auto mb-8 rounded-full"
  ></div>
</div>

<!-- Quick Stats -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
  <div
    class="bg-gradient-to-br from-white to-gray-50 rounded-xl shadow-md p-6 text-center border border-gray-200"
  >
    <div class="text-3xl font-bold text-gray-800" id="totalLeaders">70</div>
    <div class="text-gray-600 mt-1">Active Leaders</div>
    <div class="w-12 h-1 bg-gray-300 mx-auto mt-3 rounded-full"></div>
  </div>
  <div
    class="bg-gradient-to-br from-white to-gray-50 rounded-xl shadow-md p-6 text-center border border-gray-200"
  >
    <div class="text-3xl font-bold text-gray-800" id="weeklyAttendance">0</div>
    <div class="text-gray-600 mt-1">This Week's Attendance</div>
    <div class="w-12 h-1 bg-gray-300 mx-auto mt-3 rounded-full"></div>
  </div>
  <div
    class="bg-gradient-to-br from-white to-gray-50 rounded-xl shadow-md p-6 text-center border border-gray-200"
  >
    <div class="text-3xl font-bold text-gray-800" id="totalOffering">R0.00</div>
    <div class="text-gray-600 mt-1">Total Offering</div>
    <div class="w-12 h-1 bg-gray-300 mx-auto mt-3 rounded-full"></div>
  </div>
</div>

<!-- Navigation Cards -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
  <!-- View Dashboard Card -->
  <a
    href="{{ url_for('dashboard') }}"
    class="block bg-gradient-to-br from-white to-gray-50 rounded-xl shadow-md p-6 hover:shadow-xl transition-all cursor-pointer border border-gray-200 transform hover:-translate-y-1 transition-transform group"
  >
    <div class="flex items-center mb-4">
      <div
        class="w-12 h-12 bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg flex items-center justify-center mr-4 group-hover:from-accent group-hover:to-accent-dark transition-all"
      >
        <i class="fas fa-chart-bar text-white text-xl"></i>
      </div>
      <div>
        <h3 class="text-xl font-semibold text-gray-800">Analytics Dashboard</h3>
        <p class="text-gray-600 text-sm">
          View comprehensive reports and charts
        </p>
      </div>
    </div>
    <div
      class="text-gray-700 text-sm font-medium flex items-center group-hover:text-accent transition-colors"
    >
      View analytics
      <i
        class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"
      ></i>
    </div>
  </a>

  <!-- Enter Cell Totals Card -->
  <a
    href="{{ url_for('enter_totals') }}"
    class="block bg-gradient-to-br from-white to-gray-50 rounded-xl shadow-md p-6 hover:shadow-xl transition-all cursor-pointer border border-gray-200 transform hover:-translate-y-1 transition-transform group"
  >
    <div class="flex items-center mb-4">
      <div
        class="w-12 h-12 bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg flex items-center justify-center mr-4 group-hover:from-accent group-hover:to-accent-dark transition-all"
      >
        <i class="fas fa-edit text-white text-xl"></i>
      </div>
      <div>
        <h3 class="text-xl font-semibold text-gray-800">Enter Cell Totals</h3>
        <p class="text-gray-600 text-sm">Submit attendance and offering data</p>
      </div>
    </div>
    <div
      class="text-gray-700 text-sm font-medium flex items-center group-hover:text-accent transition-colors"
    >
      Submit data
      <i
        class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"
      ></i>
    </div>
  </a>

  <!-- Leaders Overview Card -->
  <a
    href="{{ url_for('leaders_management') }}"
    class="block bg-gradient-to-br from-white to-gray-50 rounded-xl shadow-md p-6 hover:shadow-xl transition-all cursor-pointer border border-gray-200 transform hover:-translate-y-1 transition-transform group"
  >
    <div class="flex items-center mb-4">
      <div
        class="w-12 h-12 bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg flex items-center justify-center mr-4 group-hover:from-accent group-hover:to-accent-dark transition-all"
      >
        <i class="fas fa-users text-white text-xl"></i>
      </div>
      <div>
        <h3 class="text-xl font-semibold text-gray-800">Leaders Management</h3>
        <p class="text-gray-600 text-sm">
          Manage leaders and contact information
        </p>
      </div>
    </div>
    <div
      class="text-gray-700 text-sm font-medium flex items-center group-hover:text-accent transition-colors"
    >
      Manage leaders
      <i
        class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"
      ></i>
    </div>
  </a>
</div>

<!-- Recent Activity Section -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
  <!-- Recent Submissions -->
  <div
    class="bg-gradient-to-br from-white to-gray-50 rounded-xl shadow-md p-6 border border-gray-200"
  >
    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
      <div
        class="w-8 h-8 bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg flex items-center justify-center mr-3"
      >
        <i class="fas fa-clock text-white"></i>
      </div>
      Recent Submissions
    </h3>
    <div id="recentSubmissions" class="space-y-3">
      <div class="text-center py-8 text-gray-500">
        <i class="fas fa-inbox text-3xl mb-3 text-gray-400"></i>
        <p>Loading recent activity...</p>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div
    class="bg-gradient-to-br from-white to-gray-50 rounded-xl shadow-md p-6 border border-gray-200"
  >
    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
      <div
        class="w-8 h-8 bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg flex items-center justify-center mr-3"
      >
        <i class="fas fa-bolt text-white"></i>
      </div>
      Quick Actions
    </h3>
    <div class="space-y-3">
      <a
        href="{{ url_for('enter_totals') }}"
        class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-accent hover:bg-accent/5 transition-all group"
      >
        <div
          class="w-8 h-8 bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg flex items-center justify-center mr-3 group-hover:from-accent/10 group-hover:to-accent-dark/10 transition-all"
        >
          <i
            class="fas fa-plus text-gray-600 group-hover:text-accent text-sm"
          ></i>
        </div>
        <div>
          <div
            class="font-medium text-gray-800 group-hover:text-accent transition-colors"
          >
            Submit New Totals
          </div>
          <div class="text-sm text-gray-600">
            Enter today's cell or service data
          </div>
        </div>
      </a>

      <a
        href="{{ url_for('leaders_management') }}"
        class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-accent hover:bg-accent/5 transition-all group"
      >
        <div
          class="w-8 h-8 bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg flex items-center justify-center mr-3 group-hover:from-accent/10 group-hover:to-accent-dark/10 transition-all"
        >
          <i
            class="fas fa-user-plus text-gray-600 group-hover:text-accent text-sm"
          ></i>
        </div>
        <div>
          <div
            class="font-medium text-gray-800 group-hover:text-accent transition-colors"
          >
            Add New Leader
          </div>
          <div class="text-sm text-gray-600">
            Register a new cell group leader
          </div>
        </div>
      </a>

      <a
        href="{{ url_for('dashboard') }}"
        class="flex items-center p-3 border border-gray-200 rounded-lg hover:border-accent hover:bg-accent/5 transition-all group"
      >
        <div
          class="w-8 h-8 bg-gradient-to-br from-gray-100 to-gray-200 rounded-lg flex items-center justify-center mr-3 group-hover:from-accent/10 group-hover:to-accent-dark/10 transition-all"
        >
          <i
            class="fas fa-chart-line text-gray-600 group-hover:text-accent text-sm"
          ></i>
        </div>
        <div>
          <div
            class="font-medium text-gray-800 group-hover:text-accent transition-colors"
          >
            View Reports
          </div>
          <div class="text-sm text-gray-600">
            Analyze growth and performance
          </div>
        </div>
      </a>
    </div>
  </div>
</div>

<script>
  // Load quick stats and recent submissions
  document.addEventListener("DOMContentLoaded", function () {
    loadQuickStats();
    loadRecentSubmissions();
  });

  async function loadQuickStats() {
    try {
      const response = await fetch("/api/stats/overview");
      const stats = await response.json();

      document.getElementById("totalLeaders").textContent = stats.total_leaders;
      document.getElementById("weeklyAttendance").textContent =
        stats.recent_submissions;
      document.getElementById("totalOffering").textContent =
        "R" + stats.total_offering.toFixed(2);
    } catch (error) {
      console.error("Error loading quick stats:", error);
    }
  }

  async function loadRecentSubmissions() {
    try {
      const response = await fetch("/api/recent-submissions");
      const submissions = await response.json();

      const container = document.getElementById("recentSubmissions");

      if (submissions.length === 0) {
        container.innerHTML = `
                <div class="text-center py-8 text-gray-500">
                    <i class="fas fa-inbox text-3xl mb-3 text-gray-400"></i>
                    <p>No submissions yet</p>
                </div>
            `;
        return;
      }

      container.innerHTML = submissions
        .slice(0, 5)
        .map(
          (submission) => `
            <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:border-accent hover:bg-accent/5 transition-all">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 rounded-lg flex items-center justify-center ${
                      submission.service_type === "sunday"
                        ? "bg-gradient-to-br from-gray-800 to-gray-900 text-white"
                        : "bg-gradient-to-br from-gray-700 to-gray-800 text-white"
                    }">
                        <i class="fas ${
                          submission.service_type === "sunday"
                            ? "fa-church"
                            : "fa-home"
                        } text-sm"></i>
                    </div>
                    <div>
                        <div class="font-medium text-gray-800">${
                          submission.leader_name
                        }</div>
                        <div class="text-sm text-gray-500">
                            ${submission.attendance} attendees · ${new Date(
            submission.service_date
          ).toLocaleDateString()}
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <div class="text-sm font-medium ${
                      submission.service_type === "sunday"
                        ? "text-gray-800"
                        : "text-gray-700"
                    }">
                        ${
                          submission.service_type === "sunday"
                            ? "Sunday"
                            : "Cell"
                        }
                    </div>
                    <div class="text-xs text-gray-500">
                        ${
                          submission.offering
                            ? "R" + submission.offering.toFixed(2)
                            : ""
                        }
                    </div>
                </div>
            </div>
        `
        )
        .join("");
    } catch (error) {
      console.error("Error loading recent submissions:", error);
    }
  }
</script>
{% endblock %}
